---
layout: post
title: "slam"
categories: Algorithm
---
# slam十四讲笔记
## 李群李代数
旋转矩阵和变换矩阵，对加法是不封闭的。
## 单目相机的成像过程
1. 首先，世界坐标系下有一个固定的点P，世界坐标Pw
2. 由于相机在运动，它的运动由R,T或变换矩阵T描述，P的相机坐标为
    Pc = RPw + t
3. 这时的Pc仍有x,y,z三个量，把他们投影到归一化平面Z=1上，得到P的归一化相机坐标：Pc= [X/Z,Y/Z,1]T
4. 最后，P的归一化坐标经过内参后，对应到像素坐标:Puv = KPc

## 双目相机的成像过程


<!-- <figure>
<a><img src="{{site.url}}/pics/branch.png"></a>
</figure> -->
<!-- ![11]({{https://github.com/zhaozz-lab/zhaozz-lab.github.io/blob/master/assets/link.jpg}}) -->


![双目相机成像](assets/双目相机成像.jpg)

## 非线性优化


## 视觉里程计
VO(visual odometry),根据相邻图像的信息，估计出粗略的相机运动，给后端提供较好的初始值。
1. 从图像中选取比较有代表性的点，这些点在相机视角发生少量变化后会保持不变，所以我们会在各个图像中找到相同的点。
2. 在这些点的基础上，讨论相机位姿的问题和这些点的定位问题（这些点在经典的slam问题中，称为路标（landmark），在视觉slam中，称为feature）

### 特征点
特征点需要满足的要求：
1.可重复性 2.可区别性 3.高效率 4.本地性
关键点： 该特征点在图像中的位置
描述子: 外观相似的特征应该有相似的描述子
#### SIFT特征
#### ORB特征
FAST是一种角点，主要检测局部像素灰度变化明显的地方，其思想是，如果一个像素与它邻域的像素差别较大（过亮或过暗），那它可能是角点。
##### FAST的执行过程
1. 在图像中选取像素p，假设他的亮度为Ip；
2. 设置一个阈值T(比如Ip的20%)
3. 以像素p为中心，选取半径为3的圆上的16个像素点。
4. 假设选取的圆上，有连续的N个点的亮度大于Ip+T或者小于Ip-T,那么像素p可以被认为是特征点（N通常取12，即为fast-12。其他常用的N值为9或者11）
5. 循环以上四步，对每一个像素执行相同的操作


##### brief 描述子
brief是一种二进制描述子，它的描述向量由多个0和1组成，这里的0和1编码了关键点附近两个像素（比如说p和q）的大小关系，比如说p比q大，则取1，反正则取0，如果我们选取了128个这样p,q,最后就得到了128维由0，1组成的向量。

#### 特征匹配
特征匹配是视觉slam中极为关键的一步，宽泛地说特征匹配解决了slam中的数据关联问题
* 暴力匹配
  $x_t^m,m=1,2...M$
  $x_(t+1)^n,n=1,2...N$
逐个比较每个特征点对应的描述子之间的距离，然后根据距离的远景对图像中的特征点进行排序
* FLANN 快速近邻最近邻

### 运动估计
1.当相机为单目时，我们只知道2D的像素坐标，因而问题是根据两组2D点估计运动。该问题采用*对极几何*来解决
2.当相机为双目，RGB-D时，或者我们通过某种方法得到了距离信息，那问题就是根据两组3D点估计运动，该问题通常用*IPC*来解决
3.如果我们有3D点和它们在相机的投影位置，也能估计相机的运动。该问题通过*PNP*来解决 。

#### 2D-2D 对极几何

![img](/img/slam/对极约束.jpg)

假设空间坐标点$P = [X,Y,Z]^T$
根据相机的针孔成像模型
$s_1p_1 = KP,s_2p_2 = K(RP+T)$

$x_1 = K^{-1}p_1,x_2 =  K^{-1}p_2$
$x_1,x_2$是两个像素点的归一化平面上的坐标，带入上式得
$x_2 = Rx_1+t$
两边同时左乘$t*$,相当于两侧同时与t做外积：
$t* {mul} x_2 = tRx_1$
todo


#### 单应矩阵





## 视觉里程计————直接法
### 光流法


















































    















